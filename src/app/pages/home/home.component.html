<div class="p-6 space-y-8">
  <!-- === Status Cards === -->
  <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-4">
    <div
      *ngFor="let stat of purchaseStats()"
      class="rounded-2xl p-5 text-white shadow cursor-pointer transition-transform hover:scale-105"
      [style.background-color]="stat.color"
      [class.opacity-50]="selectedStatus() === stat.status"
      (click)="filterByStatus(stat.status)"
    >
      <div class="text-lg font-semibold">{{ stat.title }}</div>
      <div class="text-3xl font-bold mt-2">{{ stat.count }}</div>
    </div>
  </div>

  <!-- === Filter Info + Buttons === -->
  <div class="flex flex-row-reverse justify-between items-center mt-6">
    <div class="flex gap-2">
      <button *ngIf="selectedStatus()" mat-stroked-button color="primary" (click)="resetFilter()">
        Show All
      </button>
      <button *hasPermission="'purchase:create'" mat-flat-button color="primary" cdkFocusInitial (click)="onBuyStock()">
        Buy Stock
      </button>
    </div>
    <div *ngIf="selectedStatus()" class="text-gray-700 text-sm">
      Showing purchases with status:
      <span class="font-semibold text-blue-700">{{ selectedStatus() }}</span>
    </div>
  </div>

  <!-- === Table === -->
  <div *ngIf="purchaseList().length > 0" class="mt-8">
    <ag-grid-angular
      style="width: 100%; height: 75vh"
      [rowData]="purchaseList()"
      [gridOptions]="gridOptions"
      [columnDefs]="colDefs"
      [theme]="'legacy'"
      class="ag-theme-alpine"
    ></ag-grid-angular>

    <!-- === Pagination Controls === -->
    <div class="flex justify-between items-center mt-4 px-4">
      <button mat-stroked-button color="primary" [disabled]="currentPage() === 1" (click)="prevPage()">
        Previous
      </button>

      <div class="text-sm text-gray-600">
        Page {{ currentPage() }} of {{ totalPages() }} â€”
        Total Records: {{ totalRecords() }}
      </div>

      <button
        mat-stroked-button
        color="primary"
        [disabled]="currentPage() === totalPages()"
        (click)="nextPage()"
      >
        Next
      </button>
    </div>
  </div>

  <!-- === Empty State === -->
  <div *ngIf="purchaseList().length === 0" class="text-center text-gray-500 py-12">
    <p>No purchases found for the selected status.</p>
  </div>
</div>
